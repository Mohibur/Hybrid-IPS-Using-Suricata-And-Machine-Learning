# Hybrid-IPS-Using-Suricata-And-Machine-Learning

##  Project Overview
This project was developed as an implementation of an **Intrusion Prevention System (IPS)** for a simulated high-traffic e-commerce environment.  
A hybrid approach was followed where **Suricata** was used for rule-based detection, and **Machine Learning models** were trained for anomaly-based detection.  
A **visual dashboard** was also created to analyze attack patterns and monitoring logs.



##  Objectives
- To secure a vulnerable web application against **SQL Injection (SQLi), Cross-Site Scripting (XSS), and DDoS** attacks.  
- To configure **Suricata** as an IPS for real-time traffic analysis and alert generation.  
- To apply **Machine Learning models** for improved detection of anomalies and unknown attacks.  
- To provide a **dashboard** for interactive monitoring of network activity.  



##  Tools & Technologies
- **Suricata** – Intrusion Prevention System  
- **Machine Learning (Scikit-learn)** – Logistic Regression, Random Forest, MultinomialNB, Linear SVC  
- **Python** – Data parsing, preprocessing, ML model training  
- **Streamlit** – Dashboard & visualization  
- **DVWA (Damn Vulnerable Web App)** – Used as a test environment  
- **VirtualBox (Ubuntu + Kali Linux VMs)** – Deployment setup

## About Suricata  
- Suricata is an open-source, high-performance IDS/IPS and network security monitoring engine.  
- It was used because it supports deep packet inspection, real-time intrusion detection/prevention, and exports detailed JSON logs suitable for machine learning analysis.
- It was Multi-threaded IPS which can capable of capturing the many logs at a time.

## Problems in Traditional IPS  
During the study of existing IPS solutions, several limitations were observed:  
- **Static rule dependency** → Traditional IPS relies heavily on manually written signatures, which cannot detect zero-day attacks.  
- **High false positives** → Legitimate traffic was often flagged as malicious, reducing trust in the system.  
- **Performance overhead** → Signature-based systems slowed down under high traffic conditions.  
- **Limited adaptability** → They lacked the ability to learn from new threats dynamically.  

## Why a Hybrid Approach Was Chosen  
To overcome these problems, a **hybrid IPS** was implemented by combining Suricata’s signature-based detection with machine learning models. This approach was selected because:  
- **Improved accuracy** → ML models reduced false positives by learning traffic behavior.  
- **Zero-day detection** → Anomaly-based detection allowed the system to catch attacks without pre-written rules.  
- **Scalability** → The system could adapt as more traffic and training data were introduced.  
- **Real-time prevention** → Suricata’s inline mode allowed blocking of malicious traffic immediately, while ML provided additional intelligence.   

  



##  System Architecture
- Here we chose Ubuntu VM as Victim Server And Kali VM as Attacker device. 
- A vulnerable web application was hosted on **Kali VM**.  
- **Suricata** was configured on the Ubuntu Server to capture network traffic and generate Logs (`eve.json`) which is coming towards the Ubuntu Server .  
- **Kali Linux VM** was used as an attacker machine to perform SQLi, XSS, and DoS attacks.  
- The Suricata logs were parsed and fed into ML models to classify malicious vs. benign traffic.  
- A **dashboard** was created to visualize attacks, trends, and detection results.  



##  Project Workflow
1. **Environment Setup**  
   - DVWA was deployed in Kali Linux.  
   - Suricata was installed and configured with custom rules.  
   - Attacks (SQLi, XSS, DoS) were simulated from Kali Linux.  

2. **Data Collection**  
   - Logs were generated by Suricata in `eve.json`.  
   - Features such as timestamp, source IP, destination IP, protocol, and alert signature were extracted.  

3. **Model Training**  
   - Multiple ML models (Logistic Regression, Random Forest, MultinomialNB, Linear SVC) were trained.  
   - Accuracy and false positive rates were compared.  
   - **Linear SVC** was found to give the best results.  

4. **Integration & Dashboard**  
   - Suricata rules were used for known signature-based detection.  
   - ML predictions were applied to detect anomalies and zero-day attacks.  
   - A dashboard was created  using Steamlit to monitor alerts and visualize results.

     
## Some Of The Project Visuals
### Architecture Diagram
 <img width="756" height="550" alt="file_00000000c20861f6905983db929ebbcc" src="https://github.com/user-attachments/assets/5324f737-3a9c-4f24-84fa-4d93f55580db" />
 
### Machine Learning Model Comparison
 <img width="756" height="550" alt="image" src="https://github.com/user-attachments/assets/a183f1b7-95fc-41b3-a006-c13525c3f2cf" />

### Dashboard
 <img width="756" height="550" alt="Screen Shot 2025-08-21 at 02 03 49" src="https://github.com/user-attachments/assets/e8b99a8c-5e56-40bd-8c40-6291fa3489ec" />
    
    


##  Results
- Suricata was successfully used for **signature-based detection** of SQLi and XSS attacks.  
- The Machine Learning layer improved detection accuracy and reduced false positives.  
- The **Linear SVC model** achieved the best performance among tested models.  
- A **visual monitoring dashboard** was created to provide insights into detected threats.
 


